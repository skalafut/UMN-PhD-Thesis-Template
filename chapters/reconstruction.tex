%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% reconstruction.tex:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Event Reconstruction and Selection}
\label{sec:reco_chapter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Electrons, muons and jets expected from \WR and \nul decays traverse multiple CMS sub-detectors, as shown in 
Figure \ref{fig:particleTrajectories}.  Their trajectories and energies were measured from charged particle tracks 
reconstructed by the silicon tracker and muon detectors, and energy deposits reconstructed by the calorimeters.  The 
high energy of expected leptons and jets motivated the use of specific lepton and jet reconstruction algorithms 
described here.  These algorithms combine measurements from multiple CMS sub-detectors to measure the trajectory 
and energy of each particle with the best resolution.  For charged particles, initial energy and trajectory 
measurements are made using tracks reconstructed from signals measured in the silicon tracker.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/flowOfParticlesThroughCMS.png}
	\caption{Typical trajectories of particles travelling through CMS, from CERN.}
	\label{fig:particleTrajectories}
\end{figure}


\section{Track Reconstruction}
\label{sec:trkReco}
Charged particles are reconstructed as helical tracks from signals measured in the silicon tracker.  An interative algorithm 
starts by reconstructing tracks from signals in the inner pixel tracker characterized by the highest energies or smallest 
distances from the IP, and progressively includes signals measured in outer pixel tracker and silicon strip tracker layers.  
Signals in successive layers are linked into continuous tracks using a Kalman filter that requires each signal to have 
$\chi^{2} <$ 30 \cite{trackerPerformanceInCollisions}.  Each time a new signal is added to a track, an analytic function 
extrapolates the track trajectory to the next layer assuming energy is lost only through ionization in the silicon.  Hits in 
the next layer are searched for in the region identified by the analytic function extrapolation, and this procedure repeats 
until signals are included from the outermost silicon strip tracker layer.  Then, the signals linked into tracks are removed 
from the list of track candidates, and the algorithm restarts using signals measured in the inner pixel tracker characterized 
by lower energies or larger distances from the IP.  Using this algorithm, isolated muons with $\pt > 0.9$ $\GeV$ and $|\eta| < 2.4$ 
were reconstructed as tracks with essentially 100\% efficiency \cite{trackerPerformanceInCollisions}.  After reconstructing 
all tracks in an event, each point where two or more tracks originate is identified as an interaction vertex, and its position 
is measured relative to the IP.  The positions of vertices that have muon tracks with $|\eta| < 1.4$ and $\pt = 100$ $\GeV$ 
were measured with 10 and 30 $\mu$m resolutions in the transverse (r-$\phi$) and longitudinal ($z$) directions.

The track reconstruction algorithm described previously is used to reconstruct muon and charged hadron tracks, but a second 
algorithm is used to reconstruct electron tracks.  The silicon tracker contains, depending on $\eta$, 1 to 2 radiation 
lengths of material that causes electrons to shower.  As a result, $\sim$35\% of electrons that traverse the tracker lose more 
than 70\% of their initial energies through bremsstrahlung \cite{trackerPerformanceInCollisions}, which cannot be measured by 
the tracker.  The electron track reconstruction algorithm uses the same iterative track reconstruction procedure described 
previously, but extrapolates each track's trajectory to the next silicon layer assuming the energy lost through bremsstrahlung 
is described by a sum of Gaussians.  In addition, the Kalman filter used to link signals in successive layers requires that new 
signals have $\chi^{2} <$ 2000.  The electron track algorithm reconstructed electrons with $\pt > 20$ $\GeV$ and $|\eta| < 2.5$ 
as tracks with 97\% or better efficiency \cite{gsfPerformanceInCollisions}.


\section{Energy Reconstruction}
\label{sec:enrgReco}
The energies of photons, electrons, and hadrons produced by pp interactions are measured in groups of ECAL crystals.  Photons, 
electrons, and hadrons impinging on the ECAL generate signals in the ECAL crystals that are converted into uncalibrated energies.  Groups, 
or superclusters (SCs), of crystals are built from the most energetic crystals with $\Et \gtrsim 0.2$ $\GeV$ and their nearest 
neighbors, and are at least 3 crystals wide in $\eta$.  The upstream tracker material causes $\sim$35\% of electrons and 
photons, and up to 25\% of hadrons \cite{trackerPerformanceInCollisions} to shower in the tracker, and radiate energy by emitting 
photons and other particles.  The energy is typically radiated along the particle's $\eta$ trajectory, but spread over several ECAL 
crystals in $\phi$.  To capture this energy, each SC is at least 5 crystals wide in $\phi$, and can be much larger, 
as shown in Figure \ref{fig:eleTrackAndSC}.  Once a SC is built, the energy of each crystal in the SC is multiplied by a laser 
transparency correction, and relative and absolute energy calibration corrections.  The sum of the calibrated crystal energies 
is the SC energy, and the energy weighted average $(\eta,\phi)$ position is the SC position.  Using only ECAL SCs, the $(\eta,\phi)$ 
positions of electrons in the barrel (endcap) were measured with a $\phi$ resolution of 0.17$^{\circ}$ (0.29$^{\circ}$), and an 
$\eta$ resolution of 0.001 (0.002) units.

The energies of hadrons that traverse the ECAL are measured in groups of HCAL towers.  Hadrons impinging on the HCAL generate signals 
in the HCAL towers that are converted into uncalibrated energies.  The highest energy towers with $\Et \gtrsim 1$ $\GeV$ are used to 
seed clusters, which extend to all neighboring towers with $\Et > 0.8$ $\GeV$ \cite{pflowEventReco}.  If one tower is grouped into 
multiple clusters, the tower's contribution to each cluster is weighted by its distance from each cluster's seed.  After clusters are 
built, each tower's energy is multiplied by a laser transparency correction, and relative and absolute energy calibration corrections.  
The sum of the calibrated tower energies is the cluster energy, and the energy weighted average $(\eta,\phi)$ position is the cluster 
position.  Hadron energies are measured as a combination of calibrated HCAL cluster energies, and energies of overlapping ECAL SCs.  
Using the combined ECAL-HCAL system, hadrons with $\Et = 100$ $\GeV$ were measured with a $\sim$10\% $\Et$ resolution \cite{pflowEventReco}.


\section{Muon Reconstruction and Selection}
\label{sec:muReco}

\subsection{Reconstruction}
Muons are first reconstructed as tracks from signals measured in individual muon chambers.  In each DT chamber, the start and end points of 
track segments are identified first as pairs of signals measured in the same plane (r-$\phi$ or r-z) but in different layers.  Then straight 
lines are drawn between the signal pairs, and a signal pair is ignored if its line is not compatible with a track that extrapolates from 
the chamber to the IP.  The remaining signals that are consistent with any of these straight lines are built into track segments that are 
measured in at least 3 layers.  In each plane the track segment with signals in the largest number of layers, at least 3, and the lowest 
$\chi^{2}/nDOF$, less than 20, is used to build a 3D track.  In the event where more than one track segment is reconstructed 
in one plane of a DT chamber, all combinations of r-$\phi$ and r-z track segments are considered when reconstructing a 3D track.  In 
practice, more than one 3D track is reconstructed in a DT chamber in less than 1\% of events \cite{cmsTdrPhysPerformance}.  The same 
track segment reconstruction algorithm is used in each 6 layer, single plane CSC.  There the final track segment must have signals 
in at least 4 layers.  In the barrel-endcap transition region, $1.3 < |\eta| < 1.6$, where the DT chambers stop and the CSCs begin, RPCs 
are used to improve the muon reconstruction efficiency and the precision of arrival time measurements.  Each RPC contains two parallel 
plates divided into many thin strips, and strips that measure a signal are grouped into clusters.  Each reconstructed cluster represents 
a hit whose position is the 'center of gravity' of all the strips in the cluster.

Tracks reconstructed in individual chambers are used to reconstruct muon trajectories through the magnetic field and all muon chambers.  
A Kalman filter algorithm starts with tracks in the chambers closest to the IP, and predicts the track positions in chambers in the next 
radial station with the effects of an inhomogeneous magnetic field and material losses taken into account \cite{muonRecoFirstCollisions}.  
Track segments in outer chambers are added to existing tracks subject to a $\chi^{2}$ requirement, and existing tracks are propagated to 
the next radial station even if no matching track segment is found in the current station.  Once the outermost station is included, a 
reverse Kalman filter is applied to reconstructed tracks from the outermost station working to the innermost station.  The reverse Kalman 
filter finalizes the track parameters, then these tracks are compared to silicon tracker tracks to identify global muons.

Global muons are identified using tracks reconstructed in the silicon tracker and muon detectors.  Tracks from the muon detectors are 
extrapolated back to the outermost silicon tracker layer, and their positions are compared.  In the local coordinate plane of the 
silicon strip layer, each silicon tracker track that matches a muon detector track within 3 cm is identified as a global muon.  If an 
extrapolated muon detector track has multiple silicon tracker track candidates within 3 cm, the closest match is used to make a global 
muon.  The matched silicon tracker track determines the $(\eta,\phi)$ trajectory of each global muon.

The momentum of each global muon is determined by sampling four different global muon reconstruction algorithms, and selecting the  
highest quality result.  Each algorithm fits a continuous track \cite{cmsMuonRecoRunTwo} to a unique combination of silicon tracker 
and muon detector signals to estimate a muon's trajectory through CMS, as represented in Figure \ref{fig:particleTrajectories}.  The 
quality of each continuous track is identified by a fit uncertainty $\chi^{2}/nDOF$ and momentum uncertainty $\sigma(\pt)/\pt$; and 
the track with the lowest $\chi^{2}/nDOF$ and momentum uncertainty $\sigma(\pt)/\pt < 0.3$ determines the global muon's momentum.  
For muons with $\pt \lesssim 100$ $\GeV$ the highest quality result is obtained using only silicon tracker measurements.  Muons with 
$|\eta| < 1.4$ and $\pt = 100$ $\GeV$ were measured with a $\pt$ resolution of $\sim$2.8\% \cite{trackerPerformanceInCollisions}.  
However, as a muon's $\pt$ increases above 100 $\GeV$ the silicon tracker $\pt$ resolution degrades faster that that of the muon 
detectors.  A significant fraction of $\WR \rightarrow \mu\mu jj$ events are expected to produce at least one muon with $\pt > 200$ $\GeV$ 
(Table \ref{tab:wrHighPtMuons}), and in this high $\pt$ region the highest quality momentum measurement is made by combining silicon 
tracker and muon detector measurements.  Muons with $|\eta| < 0.9$ and $200 < \pt < 400$ $\GeV$ were measured with a $\pt$ resolution 
of 3.2\%, and higher $\pt$ muons were measured with a resolution better than 6\% \cite{cmsMuonRecoRunTwo}.

\begin{table}[h]
	\caption{Fraction of expected $\WR \rightarrow \mu\mu jj$ events that had at least one muon with $\pt > 200$ $\GeV$. 
	($\mnul = \frac{1}{2}\mWR$)}
	\label{tab:wrHighPtMuons}
	\centering
	\begin{tabular}{c|c}
		\mWR ($\TeV$) & Fraction of events with at least one high-$\pt$ muon (\%) \\  \hline
		1.0 &  80.  \\
		2.0 &  95.  \\ 
		3.0 &  98.  \\ \hline
	\end{tabular}
\end{table}

Global muons reconstructed in simulated events are known to have different energies than muons reconstructed in data.  Energy 
corrections for simulated muons are derived using $Z \rightarrow \mu\mu$ events found in simulations and data.  The di-muon mass 
($M_{\mu\mu}$) distribution in $Z \rightarrow \mu\mu$ events is compared between data and simulations, and the energies of muons 
in simulated events are corrected so that the two $M_{\mu\mu}$ distributions match.

\subsection{Online Selection}
During collisions events with muons were selected using a single muon Level-1 trigger.  The trigger required one reconstructed 
track segment with $\pt > 16$ $\GeV$ that spanned one DT or CSC chamber in at least 2 stations, and the track segment in each chamber 
was built from signals in at least 4 layers.  Events were then required to pass the following single muon HLT selection criteria:

\begin{itemize}
	\item A track reconstructed in the silicon tracker with $\pt > 50$ $\GeV$ and $|\eta| < 2.4$ was geometrically matched to 
		the muon detector track segment that passed the L1 trigger.
	\item In the plane perpendicular to the beam axis, the distance between the silicon tracker track origin and its 
		reconstructed vertex was $< 1$ mm.
\end{itemize}

\subsection{Offline Identification Selection}
In events selected by the single muon trigger, muons were reconstructed offline using algorithms described previously and the full 
event information from all sub-detectors.  Prompt muons that were reconstructed from high quality signals in the muon detectors and 
the silicon tracker were selected using the following identification criteria:

\begin{itemize}
	\item The muon track reconstructed in the silicon tracker:
	\begin{itemize}
		\item Was reconstructed from a signal in at least 1 silicon pixel detector layer, and signals in at least 
			5 layers in the entire tracker.
		\item Within a cone of radius $\Delta R = 0.3$ centered on the track, the $\sum \pt$ of all other 
			reconstructed tracks was low compared to the muon $\pt$, $\frac{\sum \pt}{muon \pt} < 0.1$.
	\end{itemize}
	\item The muon was reconstructed in the muon detectors as a track segment that spanned one chamber in at least 
		2 muon stations.  Track segments in each DT chamber were required to have signals in all 4 r-$z$ layers, and 
		at least 7 of 8 r-$\phi$ layers.  Track segments in each CSC were required to have signals in all 6 layers.
	\item The origin of the muon's silicon tracker track was within 2 mm of the muon's reconstructed vertex 
		position along the $z$ axis.
\end{itemize}


\section{Electron Reconstruction and Selection}
\label{sec:eleReco}
Electrons are the only particles from \WR decays expected to lose more than a few percent of their initial energy through 
bremsstrahlung in the tracker.  A dedicated electron track reconstruction algorithm is used to reconstruct tracks from electrons, 
even those that experience large energy losses, with high efficiency, but the tracker cannot measure the magnitude of bremsstrahlung 
energy losses.  However, the energies of electrons and their bremsstrahlung photons are measured by the ECAL.  Therefore, the ECAL 
is used to measure the $\Et$ and $(\eta,\phi)$ trajectory of each electron.

Electrons are identified using reconstructed tracks and ECAL SCs.  Reconstructed tracks are extrapolated from the outermost 
silicon strip layer to the front face of the ECAL, and their positions are compared to ECAL SCs.  Each electron is identified 
as one or more tracks that match the SC $(\eta,\phi)$ position within 1.1$^{\circ}$, about 1 crystal wide, in $\phi$, and 
within 0.004 units, less than $\frac{1}{2}$ a crystal wide, in $\eta$.  In addition, the ECAL SC $\Et$ and the matched 
track $\pt$ must agree within the uncertainty on the track $\pt$.  Using the SC energy, electrons with $\Et \approx 45$ 
$\GeV$ and $|\eta| < 0.8$ were measured with an $\Et$ resolution better than 2\%, and a resolution between 2\% and 5\% 
for higher $|\eta|$ \cite{ecalPerformanceInCollisions}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/electronTrackAndSupercluster.png}
	\caption{The trajectory of a typical electron through the tracker and the ECAL.}
	\label{fig:eleTrackAndSC}
\end{figure}

Electrons reconstructed in simulated events are known to have different energies than electrons reconstructed in data.  Energy 
corrections for simulated electrons are derived using $Z \rightarrow ee$ events found in simulations and data.  The di-electron mass 
($M_{ee}$) distribution in $Z \rightarrow ee$ events is compared between data and simulations, and the energies of electrons 
in simulated events are corrected so that the two $M_{ee}$ distributions match.


\section{Jet Reconstruction and Selection}
\label{sec:jetReco}
Quarks and gluons emitted from pp interactions produced jets of photons, hadrons and leptons.  On average, 85\% of a jet's 
energy is carried by charged particles and photons \cite{pflowJetRecoInCollisions}, so these particles are prioritized during 
jet reconstruction.  The particle flow jet reconstruction algorithm \cite{pflowEventReco} identifies $(\eta,\phi)$ regions 
with one or more silicon tracker or muon detector tracks, one or more HCAL energy clusters, and any number of ECAL 
SCs.  In these regions, algorithms described previously are used to reconstruct muons first, followed by electrons.  Tracks and 
energy deposits identified as leptons are removed from the list of particle candidates.  The remaining tracks and energy clusters 
are used to identify charged hadrons, photons, and neutral hadrons.  Each charged hadron is identified as a track linked to an HCAL 
cluster and possibly an ECAL SC, and the track $\pt$ must agree with the total calorimeter $\Et$ within the calorimeter $\Et$ 
uncertainty.  Each photon is identified as an ECAL SC that fails the electron track-SC matching requirement, or an ECAL SC that 
matches a significantly lower energy HCAL cluster or track.  Finally, each neutral hadron is identified as an HCAL cluster and 
an overlapping ECAL SC that are not matched to a track, or are matched to a track with significantly lower $\pt$.  Then a jet is 
clustered from reconstructed particles in each region, as shown in Figure \ref{fig:jetClustering}.

Due to the high instantaneous collision luminosity, each pp bunch crossing delivered by the LHC yields multiple pp interactions, 
or pileup (PU) interactions, that makes jet clustering more challenging.  In every unit of $\eta$, each PU interaction adds 
$\sim$11 charged particle tracks with $\pt \approx 0.5$ $\GeV$ to the event \cite{chgdHdrMultInData}.  These tracks are primarily 
from charged hadrons, so before jets are clustered the charged hadrons associated with PU interaction vertices are removed from 
all jet clustering regions.  Jets are then clustered from reconstructed particles using the anti-$k_{T}$ algorithm \cite{antikt} 
with a cone size of $\Delta R = 0.4$.  In each region the anti-$k_{T}$ algorithm starts with the highest $\Et$ hadron and adds 
other particles to the jet cone based on their $\pt$ and distance from the jet axis.  A cone size of $\Delta R = 0.4$ was used 
to reduce the likelihood of having a jet with radius $\Delta R > 0.4$, which would be more sensitive to pileup contributions.  
Once jets are clustered a second technique is used to reduce the contribution of neutral particles produced in PU interactions 
to jet energies.  In this technique, the $k_{T}$ algorithm \cite{ktAlgoOne,ktAlgoTwo,ktAlgoThree} with cone size $\Delta R = 0.3$ 
is used to cluster jets from all particles reconstructed in the event, including jets that only contain photon and neutral hadrons.  
Each $k_{T}$ jet's $\pt$ is divided by the jet's area ($\pt_{j} / A_{j}$), and the median value represents the average neutral 
particle energy density in the event \cite{pileup1,pileup2}.  Using the hybrid jet area subtraction technique described in 
\cite{pflowJetRecoInCollisions}, the photon and neutral hadron energies in each anti-$k_{T}$ jet are reduced based on each jet's 
area and $\eta$.  After all subtractions, jet energies are calibrated based on known variations in the detector response to jets 
as functions of $\eta$ and $\pt$.  By combining measurements from the silicon tracker, calorimeters, and muon detectors, particle 
flow jets with $\pt > 50$ $\GeV$ and $|\eta| < 3.0$ were measured with $\pt$ resolution better than 15\% \cite{jetResolutionInCollisions}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/jetClusteringInCMS.png}
	\caption{A cone of reconstructed particles clustered into a jet, with the reconstructed vertex on the right.  
	From the CMS Experiment.}
	\label{fig:jetClustering}
\end{figure}

Jets reconstructed in simulated events are known to have different energies than jets reconstructed in data.  Energy corrections for 
simulated jets are derived using dijet, $Z \rightarrow \ell\ell$+jet, and $\gamma$+jet events found in simulations and data 
\cite{jetpaper}.  The di-jet mass and leading jet $\pt$ distributions in these events are compared between data and simulations, and 
the energies of jets in simulated events are corrected so that the distributions match in data and simulations.


\section{Conclusion}
\label{sec:recoConclusion}
Energetic electrons, muons and jets produced in collisions are reconstructed from signals measured in CMS sub-detectors and using 
specialized reconstruction algorithms.  Reconstructed leptons and jets were required to pass additional selections to increase 
sensitivity to a \WR signal relative to ST backgrounds.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
