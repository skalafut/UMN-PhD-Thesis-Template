%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% reconstruction.tex:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Event Reconstruction and Selection}
\label{sec:reco_chapter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Electrons, muons and jets expected from \WR and \nul decays traverse multiple CMS sub-detectors, as shown in 
Figure \ref{fig:particleTrajectories}.  Their trajectories and energies were measured from charged particle tracks 
reconstructed by the silicon tracker and muon detectors, and energy deposits reconstructed by the calorimeters.  The 
high energy of expected leptons and jets motivated the use of specific lepton and jet reconstruction algorithms 
described here.  These algorithms combine measurements from multiple CMS sub-detectors to measure the trajectory 
and energy of each particle with optimal resolution.  For charged particles, initial energy and trajectory 
measurements are made using tracks reconstructed from signals measured in the silicon tracker.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/flowOfParticlesThroughCMS.png}
	\caption{Typical trajectories of particles travelling through CMS, from CERN.}
	\label{fig:particleTrajectories}
\end{figure}


\section{Track Reconstruction}
\label{sec:trkReco}
Charged particles are reconstructed as helical tracks from signals measured in the silicon tracker.  An interative algorithm 
starts by reconstructing tracks from signals in the inner pixel tracker characterized by the highest energies or smallest 
distances from the IP, and progressively includes signals measured in outer pixel tracker and silicon strip tracker layers.  
Signals in successive layers are linked into continuous tracks using a Kalman filter that requires each signal to have 
$\chi^{2} <$ 30 \cite{trackerPerformanceInCollisions}.  Each time a new signal is added to a track, an analytic function 
extrapolates the track trajectory to the next layer assuming energy is lost only through ionization in the silicon.  Hits in 
the next layer are searched for in the region identified by the analytic function extrapolation, and this procedure repeats 
until signals are included from the outermost silicon strip tracker layer.  Then, the signals linked into tracks are removed 
from the list of track candidates, and the algorithm restarts using signals measured in the inner pixel tracker characterized 
by lower energies or larger distances from the IP.  Using this algorithm, isolated muons with $\pt > 0.9$ $\GeV$ and $|\eta| < 2.4$ 
were reconstructed as tracks with essentially 100\% efficiency \cite{trackerPerformanceInCollisions}.  After reconstructing 
all tracks in an event, each point where two or more tracks originate is identified as an interaction vertex, and its position 
is measured relative to the IP.  The positions of vertices that have muon tracks with $|\eta| < 1.4$ and $\pt = 100$ $\GeV$ 
were measured with 10 and 30 $\mu$m resolutions in the transverse (r-$\phi$) and longitudinal ($z$) directions.

The track reconstruction algorithm described previously is used to reconstruct muon and charged hadron tracks, but a second 
algorithm is used to reconstruct electron tracks.  The silicon tracker contains, depending on $\eta$, 1 to 2 radiation 
lengths of material that causes electrons to shower.  As a result, $\sim$35\% of electrons that traverse the tracker lose more 
than 70\% of their initial energies through bremsstrahlung \cite{trackerPerformanceInCollisions}, which cannot be measured by 
the tracker.  The electron track reconstruction algorithm uses the same iterative track reconstruction procedure described 
previously, but extrapolates each track's trajectory to the next silicon layer assuming the energy lost through bremsstrahlung 
is described by a sum of Gaussians.  In addition, the Kalman filter used to link signals in successive layers requires that new 
signals have $\chi^{2} <$ 2000.  The electron track algorithm reconstructed electrons with $\pt > 20$ $\GeV$ and $|\eta| < 2.5$ 
as tracks with 97\% or better efficiency \cite{gsfPerformanceInCollisions}.


\section{Energy Reconstruction}
\label{sec:enrgReco}
The energies of photons, electrons, and hadrons produced by pp interactions are measured in groups of ECAL crystals.  Photons, 
electrons, and hadrons impinging on the ECAL generate signals in the ECAL crystals that are converted into uncalibrated energies.  Groups, 
or superclusters (SCs), of crystals are built from the most energetic crystals with $\Et \gtrsim 0.2$ $\GeV$ and their nearest 
neighbors, and are at least 3 crystals wide in $\eta$.  The upstream tracker material causes $\sim$35\% of electrons and 
photons, and up to 25\% of hadrons \cite{trackerPerformanceInCollisions} to shower in the tracker, and radiate energy by emitting 
photons and other particles.  The energy is typically radiated along the particle's $\eta$ trajectory, but spread over several ECAL 
crystals in $\phi$.  To capture this energy, each SC is at least 5 crystals wide in $\phi$, and can be much larger, as in 
Figure \ref{fig:eleTrackAndSC}.  Once a SC is built, the energy of each crystal in the SC is multiplied by a laser 
transparency correction, and relative and absolute energy calibration corrections.  The sum of the calibrated crystal energies 
is the SC energy, and the energy weighted average $(\eta,\phi)$ position is the SC position.  Using only ECAL SCs, the $(\eta,\phi)$ 
positions of electrons in the barrel (endcap) were measured with a $\phi$ resolution of 0.17$^{\circ}$ (0.29$^{\circ}$), and an 
$\eta$ resolution of 0.001 (0.002) units.

The energies of hadrons that traverse the ECAL are measured in groups of HCAL towers.  Hadrons impinging on the HCAL generate signals 
in the HCAL towers that are converted into uncalibrated energies.  The highest energy towers with $\Et \gtrsim 1$ $\GeV$ are used to 
seed clusters, which extend to all neighboring towers with $\Et > 0.8$ $\GeV$ \cite{pflowEventReco}.  If one tower is grouped into 
multiple clusters, the tower's contribution to each cluster is weighted by its distance from each cluster's seed.  After clusters are 
built, each tower's energy is multiplied by a laser transparency correction, and relative and absolute energy calibration corrections.  
The sum of the calibrated tower energies is the cluster energy, and the energy weighted average $(\eta,\phi)$ position is the cluster 
position.  Hadron energies are measured as a combination of calibrated HCAL cluster energies, and energies of overlapping ECAL SCs.  
Using the combined ECAL-HCAL system, hadrons with $\Et = 100$ $\GeV$ were measured with a $\sim$10\% $\Et$ resolution \cite{pflowEventReco}.


\section{Muon Reconstruction and Selection}
\label{sec:muReco}

\subsection{Reconstruction}
Muons are first reconstructed as tracks from signals measured in individual muon chambers.  In each DT chamber, the start and end points of 
track segments are identified first as pairs of signals measured in the same plane (r-$\phi$ or r-z) but in different layers.  Then straight 
lines are drawn between the signal pairs, and a signal pair is ignored if its line is not compatible with a track that extrapolates from 
the chamber to the IP.  The remaining signals that are consistent with any of these straight lines are built into track segments that are 
measured in at least 3 layers.  In each plane the track segment with signals in the largest number of layers, at least 3, and the lowest 
$\chi^{2}/nDOF$, less than 20, is used to build a 3D track.  In the event where more than one track segment is reconstructed 
in one plane of a DT chamber, all combinations of r-$\phi$ and r-z track segments are considered when reconstructing a 3D track.  In 
practice, more than one 3D track is reconstructed in a DT chamber in less than 1\% of events \cite{cmsTdrPhysPerformance}.  The same 
track segment reconstruction algorithm is used in each 6 layer, single plane CSC.  There the final track segment must have signals 
in at least 4 layers.  In the barrel-endcap transition region, $1.3 < |\eta| < 1.6$, where the DT chambers stop and the CSCs begin, RPCs 
are used to improve the muon reconstruction efficiency and the precision of arrival time measurements.  Each RPC contains two parallel 
plates divided into many thin strips, and strips that measure a signal are grouped into clusters.  Each reconstructed cluster represents 
a hit whose position is the 'center of gravity' of all the strips in the cluster.

Tracks reconstructed in individual chambers are used to reconstruct muon trajectories through the magnetic field and all muon chambers.  
A Kalman filter algorithm starts with tracks in the chambers closest to the IP, and predicts the track positions in chambers in the next 
radial station with the effects of an inhomogeneous magnetic field and material losses taken into account \cite{muonRecoFirstCollisions}.  
Track segments in outer chambers are added to existing tracks subject to a $\chi^{2}$ requirement, and existing tracks are propagated to 
the next radial station even if no matching track segment is found in the current station.  Once the outermost station is included, a 
reverse Kalman filter is applied to reconstructed tracks from the outermost station working to the innermost station.  The reverse Kalman 
filter finalizes the track parameters, then these tracks are compared to silicon tracker tracks to identify global muons.

Global muons are identified using tracks reconstructed in the silicon tracker and muon detectors.  Tracks from the muon detectors are 
extrapolated back to the outermost silicon tracker layer, and their positions are compared.  In the local coordinate plane of the 
silicon strip layer, each silicon tracker track that matches a muon detector track within 3 cm is identified as a global muon.  If an 
extrapolated muon detector track has multiple silicon tracker track candidates within 3 cm, the closest match is used to make a global 
muon.  The matched silicon tracker track determines the $(\eta,\phi)$ trajectory of each global muon.

The momentum of each global muon is determined by sampling four different global muon reconstruction algorithms, and selecting the  
highest quality result.  Each algorithm fits a continuous track \cite{cmsMuonRecoRunTwo} to a unique combination of silicon tracker 
and muon detector signals to estimate a muon's trajectory through CMS, depicted in Figure \ref{fig:particleTrajectories}.  The 
quality of each continuous track is identified by a fit uncertainty $\chi^{2}/nDOF$ and momentum uncertainty $\sigma(\pt)/\pt$; and 
the track with the lowest $\chi^{2}/nDOF$ and momentum uncertainty $\sigma(\pt)/\pt < 0.3$ determines the global muon's momentum.  
For muons with $\pt \lesssim 100$ $\GeV$ the highest quality result is obtained using only silicon tracker measurements.  Muons with 
$|\eta| < 1.4$ and $\pt = 100$ $\GeV$ were measured with a $\pt$ resolution of $\sim$2.8\% \cite{trackerPerformanceInCollisions}.  
However, as a muon's $\pt$ increases above 100 $\GeV$ the silicon tracker $\pt$ resolution degrades faster that that of the muon 
detectors.  A significant fraction of $\WR \rightarrow \mu\mu jj$ events are expected to produce at least one muon with $\pt > 200$ $\GeV$ 
(Table \ref{tab:wrHighPtMuons}), and in this high $\pt$ region the highest quality momentum measurement is made by combining silicon 
tracker and muon detector measurements.  Muons with $|\eta| < 0.9$ and $200 < \pt < 400$ $\GeV$ were measured with a $\pt$ resolution 
of 3.2\%, and higher $\pt$ muons were measured with a resolution better than 6\% \cite{cmsMuonRecoRunTwo}.

\begin{table}[h]
	\caption{Fraction of expected $\WR \rightarrow \mu\mu jj$ events that had at least one muon with $\pt > 200$ $\GeV$. 
	($\mnul = \frac{1}{2}\mWR$)}
	\label{tab:wrHighPtMuons}
	\centering
	\begin{tabular}{c|c}
		\mWR ($\TeV$) & Fraction of events with at least one high-$\pt$ muon (\%) \\  \hline
		1.0 &  80.  \\
		2.0 &  95.  \\ 
		3.0 &  98.  \\ \hline
	\end{tabular}
\end{table}

Global muons reconstructed in simulated events are known to have different energies than muons reconstructed in data.  Energy 
corrections for simulated muons are derived using $Z \rightarrow \mu\mu$ events found in simulations and data.  The di-muon mass 
($M_{\mu\mu}$) distribution in $Z \rightarrow \mu\mu$ events is compared between data and simulations, and the energies of muons 
in simulated events are corrected so that the two $M_{\mu\mu}$ distributions match.

\subsection{Online Selection}
During collisions events with muons were selected using a single muon Level-1 trigger.  The trigger required one reconstructed 
track segment with $\pt > 16$ $\GeV$ that spanned one DT or CSC chamber in at least 2 stations, and the track segment in each chamber 
was built from signals in at least 4 layers.  Then, events were required to pass the following single muon HLT selection criteria:

\begin{itemize}
	\item A track reconstructed in the silicon tracker with $\pt > 50$ $\GeV$ and $|\eta| < 2.4$ was geometrically matched to 
		the muon detector track segment that passed the L1 trigger.
	\item In the plane perpendicular to the beam axis, the distance between the silicon tracker track origin and its 
		reconstructed vertex was $< 1$ mm.
\end{itemize}

\subsection{Offline Identification Selection}
In events selected by the single muon trigger, muons were reconstructed offline from muon detector and silicon tracker tracks using 
algorithms described previously.  After reconstruction, the following identification criteria were applied to select promptly produced, 
isolated muons that were reconstructed in multiple muon stations:

\begin{itemize}
	\item The muon track reconstructed in the silicon tracker:
	\begin{itemize}
		\item Was reconstructed from a signal in at least 1 silicon pixel detector layer, and signals in at least 
			5 layers in the entire tracker.
		\item Within a cone of radius $\Delta R = 0.3$ centered on the track, the $\sum \pt$ of all other 
			reconstructed tracks was low compared to the muon $\pt$, $\frac{\sum \pt}{\mu \pt} < 0.1$.
	\end{itemize}
	\item The muon was reconstructed in the muon detectors as a track segment that spanned one chamber in at least 
		2 muon stations.  Track segments in each DT chamber were required to have signals in all 4 r-$z$ layers, and 
		at least 7 of 8 r-$\phi$ layers.  Track segments in each CSC were required to have signals in all 6 layers.
	\item The origin of the muon's silicon tracker track was within 2 mm of the muon's reconstructed vertex 
		position along the $z$ axis.
\end{itemize}


\section{Electron Reconstruction and Selection}
\label{sec:eleReco}

\subsection{Reconstruction}
Electrons are the only particles from \WR decays expected to lose more than a few percent of their initial energy through 
bremsstrahlung in the tracker.  A dedicated electron track reconstruction algorithm is used to reconstruct tracks from electrons, 
even those that experience large energy losses, with high efficiency, but the tracker cannot measure the magnitude of bremsstrahlung 
energy losses.  However, the energies of electrons and their bremsstrahlung photons are measured by the ECAL.  Therefore, the ECAL 
is used to measure the $\Et$ and $(\eta,\phi)$ trajectory of each electron.

Electrons are identified using reconstructed tracks and ECAL SCs.  Reconstructed tracks are extrapolated from the outermost 
silicon strip layer to the front face of the ECAL, and their positions are compared to ECAL SCs.  Each electron is identified 
as one or more tracks that match the SC $(\eta,\phi)$ position within 1.1$^{\circ}$, about 1 crystal wide, in $\phi$, and 
within 0.004 units, less than $\frac{1}{2}$ a crystal wide, in $\eta$.  In addition, the ECAL SC $\Et$ and the matched 
track $\pt$ must agree within the uncertainty on the track $\pt$.  Using the SC energy, electrons with $\Et \approx 45$ 
$\GeV$ and $|\eta| < 0.8$ were measured with an $\Et$ resolution better than 2\%, and a resolution between 2\% and 5\% 
at higher $|\eta|$ \cite{ecalPerformanceInCollisions}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/electronTrackAndSupercluster.png}
	\caption{The trajectory of a typical electron through the tracker and the ECAL.}
	\label{fig:eleTrackAndSC}
\end{figure}

Electrons reconstructed in simulated events are known to have different energies than electrons reconstructed in data.  Energy 
corrections for simulated electrons are derived using $Z \rightarrow ee$ events found in simulations and data.  The di-electron mass 
($M_{ee}$) distribution in $Z \rightarrow ee$ events is compared between data and simulations, and the energies of electrons 
in simulated events are corrected so that the two $M_{ee}$ distributions match.

\subsection{Online Selection}
During collisions events with electrons were selected using single and double-electron Level-1 triggers.  These triggers required 
either one 5 $\times$ 5 ECAL crystal cluster reconstructed with $\Et > 40$ $\GeV$, or two 5 $\times$ 5 ECAL clusters: one with 
$\Et > 22$ $\GeV$, the other with $\Et > 10$ $\GeV$.  Then, events were required to pass the following double-electron HLT selection 
criteria:

\begin{itemize}
	\item Two 5 $\times$ 5 ECAL crystal clusters separated by $\Delta R > 0.1$ were reconstructed with $\Et > 33$ $\GeV$.
	\item For each ECAL cluster:
	\begin{itemize}
		\item The ratio of energy (H) in the HCAL tower behind the cluster to the cluster energy (E) was $\frac{H}{E} < 0.15$ 
			in the barrel, and $\frac{H}{E} < 0.1$ in the endcap.
		\item Ninety percent of the cluster energy was measured in an area that was two crystals wide in $\eta$.
		\item If the cluster was in the barrel, a reconstructed track with signals in at least two pixel tracker layers 
			extrapolated close to the cluster position.  The track extrapolated from the pixel tracker to within $2.3$ cm 
			of the ECAL cluster $z$ position, and to within 1 ECAL crystal area of the cluster $(\eta,\phi)$ position.
	\end{itemize}
\end{itemize}

\subsection{Offline Identification Selection}
In events selected by the double-electron trigger, electrons were reconstructed offline from ECAL SCs and tracks using algorithms 
described previously.  After reconstruction, the following identification criteria were applied to select promptly produced 
electrons that did not lose significant energy in the tracker, and were not reconstructed near a jet:

\begin{itemize}
	\item Electrons reconstructed with $1.44 < |\eta| < 1.57$ were ignored.
	\item For barrel electrons, at least 94\% of the SC energy was measured in an $\eta$ region that was 2 crystals 
		wide.
	\item The ratio of energy (H) in the HCAL tower behind the SC to the SC energy ($E_{SC}$) was $\frac{H}{E_{SC}}< 0.05 + \frac{1}{E_{SC}}$ 
		in the barrel, and $\frac{H}{E_{SC}}< 0.05 + \frac{5}{E_{SC}}$ in the endcap.
	\item In a $\Delta R =$ 0.3 radius cone centered on the electron's $(\eta, \phi)$ trajectory:
	\begin{itemize}
		\item The $\sum \pt$ of all tracks excluding the electron's track was low, $\sum \pt < 5$ $\GeV$.
		\item The total calorimeter energy $E_{ECAL + HCAL}$ in the cone not associated with the electron was low, 
			$E_{ECAL + HCAL} < 2 + 0.03\alpha + 0.28\rho$.  $\rho$ was the neutral particle energy per unit $\eta,\phi$ area, 
			$\alpha$ in the barrel was the electron $\Et$, and $\alpha$ in the endcap was the electron $\Et - 50$.
	\end{itemize}
	\item The electron track extrapolated from the outermost silicon tracker measurement to within $\sim$3 crystal 
		widths in $\phi$ of the SC seed crystal position.
	\item The electron track was built from signals in every silicon pixel and inner strip detector layers, or all but 1 layer.
	\item The electron track's origin was separated from its vertex by a small distance $\Delta_{xy}$ in the $x-y$ 
		plane: $\Delta_{xy} < 0.2$ mm in the tracker barrel, and $\Delta_{xy} < 0.5$ mm in the tracker endcap.
\end{itemize}


\section{Jet Reconstruction and Selection}
\label{sec:jetReco}

\subsection{Reconstruction}
Quarks and gluons emitted from pp interactions produced jets of photons, hadrons and leptons.  On average, 85\% of a jet's 
energy is carried by charged particles and photons \cite{pflowJetRecoInCollisions}, so these particles are prioritized during 
jet reconstruction.  The particle flow jet reconstruction algorithm \cite{pflowEventReco} identifies $(\eta,\phi)$ regions 
with one or more silicon tracker or muon detector tracks, one or more HCAL energy clusters, and any number of ECAL 
SCs.  In these regions, algorithms described previously are used to reconstruct muons first, followed by electrons.  Tracks and 
energy deposits identified as leptons are removed from the list of particle candidates.  The remaining tracks and energy clusters 
are used to identify charged hadrons, photons, and neutral hadrons.  Each charged hadron is identified as a track matched to an HCAL 
cluster and possibly an ECAL SC, and the charged hadron's $\pt$ and $(\eta,\phi)$ trajectory are determined by the track.  The track 
$\pt$ must agree with the total calorimeter $\Et$ within the calorimeter $\Et$ uncertainty.  Each photon is identified as an ECAL SC 
that are not geometrically matched to a track or HCAL cluster whose $\pt$ or $\Et$ agrees with the SC $\Et$ within the ECAL $\Et$ 
uncertainty.  Finally, each neutral hadron is identified as an HCAL cluster and any overlapping ECAL SC that are not geometrically 
matched to a track whose $\pt$ agrees with the calorimeter $\Et$ within the calorimeter $\Et$ uncertainty.  After all tracks and 
energy clusters in a region are identified as specific particles, a jet, represented by the cone in Figure \ref{fig:jetClustering}, 
is clustered from those particles.

Due to the high instantaneous collision luminosity, each pp bunch crossing delivered by the LHC produces multiple pp interactions, 
or pileup (PU) interactions, that make jet clustering more challenging.  In every unit of $\eta$, each PU interaction adds 
$\sim$11 charged particle tracks with $\pt \approx 0.5$ $\GeV$ to the event \cite{chgdHdrMultInData}.  These tracks are primarily 
charged hadrons, so before jets are clustered the charged hadrons associated with PU interaction vertices are removed from 
all jet clustering regions.  Jets are then clustered from reconstructed particles using the anti-$k_{T}$ algorithm \cite{antikt} 
with a cone size of $\Delta R = 0.4$.  In each region the anti-$k_{T}$ algorithm starts with the highest $\pt$ hadron and adds 
other particles to the jet cone based on their $\pt$ and distance from the jet axis.  A cone size of $\Delta R = 0.4$ is used to 
cluster lower area jets that are less sensitive to PU contamination, but does not prohibit jets from being clustered with radius 
$\Delta R > 0.4$.  Once jets are clustered a second technique is used to reduce the contribution of neutral particles produced in PU interactions 
to jet energies.  This technique uses the $k_{T}$ algorithm \cite{ktAlgoOne,ktAlgoTwo,ktAlgoThree} with cone size $\Delta R = 0.3$ 
to cluster jets from all particles reconstructed in the event, including jets that only contain neutral particles.  
Each $k_{T}$ jet's $\pt$ is divided by the jet's area ($\pt_{j} / A_{j}$), and the median value $\rho$ is used as the average neutral 
particle energy density in the event \cite{pileup1,pileup2}.  Using the hybrid jet area subtraction technique described in 
\cite{pflowJetRecoInCollisions}, the photon and neutral hadron energies in each anti-$k_{T}$ jet are reduced based on $\rho$, and each 
jet's area and $\eta$.  After all subtractions, jet energies are calibrated to correct for known variations in the detector response to jets 
as functions of $\eta$ and $\pt$.  By combining measurements from the silicon tracker, calorimeters, and muon detectors, particle 
flow jets with $\pt > 40$ $\GeV$ and $|\eta| < 2.4$ were measured with a $\pt$ resolution better than 13\% \cite{jetResolutionInCollisions}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.75\textwidth]{figures/jetClusteringInCMS.png}
	\caption{A cone of reconstructed particles clustered into a jet, with the reconstructed vertex on the right.  
	From the CMS Experiment.}
	\label{fig:jetClustering}
\end{figure}

Jets reconstructed in simulated events are known to have different energies than jets reconstructed in data.  Energy corrections for 
simulated jets are derived using dijet, $Z$+jet, and $\gamma$+jet events found in simulations and data 
\cite{jetpaper}.  The di-jet mass and leading jet $\pt$ distributions in these events are compared between data and simulations, and 
the energies of jets in simulated events are corrected so that the jet distributions match in data and simulations.

\subsection{Offline Identification Selection}
In events selected by the single muon or double-electron trigger, jets were reconstructed offline from tracks and calorimeter energy 
clusters using algorithms described previously.  After reconstruction, the following identification criteria were applied to select 
jets that contained at least one energetic charged hadron, and whose energies were not dominated by ECAL SCs disconnected from HCAL 
clusters:

\begin{itemize}
	\item The jet had at least 2 constituents.
	\item The jet had at least 1 charged hadron constituent.
	\item More than 0\% of the total jet energy came from charged hadrons.
	\item Less than 90\% of the total jet energy came from neutral hadrons.
	\item Less than 90\% of the total jet energy came from photons.
	\item Less than 99\% of the total jet energy came from electrons.
\end{itemize}


\section{\WR Signal and ST Backgrounds Kinematics}
\label{sec:signalAndBkgnds}
The data is expected to contain events where two charged leptons ($\ell$) and two jets are reconstructed.  These events are produced 
by ST background processes like $\DY$+jets, and their final state leptons and jets conceal the $\WR \rightarrow \ell\ell jj$ decay 
signature.

The heavy \WR decays through a lighter \nul to an $\ell\ell jj$ final state according to the following decay chain:

\begin{tikzpicture}[grow=right]
	\node (Wr) at (0,0) {$\WR \thickspace \rightarrow \thickspace \nul + \ell$};
	\node (Ar) at (0.75,-0.4) {$\searrow$};
	\node (Nl) at (1.25,-0.75) {$\ell jj$};
\end{tikzpicture} $\newline$
The previous \WR and \nul search \cite{cmsWRRunOneResults} excluded \WR production at 95\% CL for $\mWR < 3$ $\TeV$ and 
$90 \GeV \lesssim \mnul < \mWR$, so the \WR and \nul lifetimes, inversely proportional to their masses, are expected to be very short.  
Therefore, \WR and \nul decay promptly to leptons, and quarks that hadronize into jets.

The majority of background events are produced by the $\DY$+jets process and processes with at least one top quark; the remaining events are 
produced by diboson (WW, WZ, ZZ), W+jets, and QCD multi-jet processes.  \DY produces two same flavor leptons at a rate that decreases 
rapidly as a function of di-lepton mass above 120 $\GeV$.  The \DY interaction occurs between two quarks, and at $\sqrt{s} = 13$ $\TeV$ 
the probability for either quark to radiate a parton, the QCD coupling $\alpha_{QCD}$, is $\sim$0.1.  Thus, in $\alpha_{QCD}^{2} \sim$0.01 
$=$1\% of \DY events the initial quarks radiate two partons before interacting.  Unlike \DY, the top quark background, including 
$t\bar{t}$ and t+W, produces $\ell\ell jj$ final states without initial state parton radiation.  The top quark background is 
also the only significant background that produces $e\mu jj$ final states twice as often as same flavor $\ell\ell jj$ final states.  The 
$e\mu/\ell\ell$ ratio is used to predict the top quark background, using methods described later.  Amongst the remaining backgrounds, only 
WZ and ZZ production yield $\ell\ell jj$ final states without initial state parton radiation.  The other backgrounds - $qq/qg/gg \rightarrow$ 
WW, W+jets, and QCD multi-jet - yield $\ell\ell jj$ final states only when the interacting quarks or gluons radiate partons, or when real 
jets are incorrectly reconstructed as leptons.

\subsection{Signal and Background Kinematics}
\mWR and the ratio $\mnul/\mWR$ govern the kinematics, like $\pt$ and $(\eta,\phi)$ trajectory, of the final state leptons and jets in 
\WR events.  The \WR has been excluded by previous searches at 95\% CL for $\mWR < 3$ $\TeV$, so the expected \mWR is large relative to 
the $\sqrt{s} = 13$ $\TeV$ collision energy.  Thus \WR bosons are expected to have low net momentum, so in the lab frame their progeny \nul 
and $\ell$ are emitted isotropically.  In addition, the final state leptons and jets are produced with high $\pt$ 
(Figure \ref{fig:wrLeptJetPts}) and low $|\eta|$ (Figure \ref{fig:wrLeptJetEtas}).  At a specific \mWR, however large it is, the ratio 
$\mnul/\mWR$ affects how the total energy \mWR is split amongst the leptons and jets, and their $(\eta,\phi)$ trajectories.  As 
$\mnul/\mWR$ approaches 1 the $\ell_{1}$, from $\WR \rightarrow \ell_{1}\nul$, is emitted with lower average transverse energy; the 
$\ell_{2}$ and both jets, from $\nul \rightarrow \ell_{2}jj$, are emitted with higher average transverse energy.  Conversely, as 
$\mnul/\mWR$ approaches 0 the $\ell_{1}$ carries more energy, and the $\ell_{2}$ and both jets carry less energy.  These trends 
in lepton and jet transverse energies as a function of $\mnul/\mWR$ are shown in 
Figure \ref{fig:wrLeptQrkPtsVarMNu}.  Furthermore, as $\mnul/\mWR$ approaches 0 the \nul is emitted with larger momentum (Figure 
\ref{fig:hvyNuMomentumVarMNu}).  The \nul momentum is conserved in its decay, and as that momentum increases the $\ell_{2} jj$ system 
in the lab frame is preferentially emitted, or boosted, along the \nul $(\eta,\phi)$ trajectory.  The boost of the \nul decay products 
decreases the $\Delta R(\ell,j)$ separation between $\ell_{2}$ and both jets (Figure \ref{fig:wrDrLeptQrkVarMNu}).  Since the \nul recoils 
against $\ell_{1}$ to conserve the \WR momentum in $\WR \rightarrow \ell_{1}\nul$, the boost at low $\mnul/\mWR$ increases the angle 
between $\ell_{1}$ and $\ell_{2}$ (Figure \ref{fig:wrLeptAngleSepVarMNu}).  The $\ell_{1}\ell_{2}$ invariant mass ($\Mll$) increases 
with the angle between the leptons, so the boost at low $\mnul/\mWR$ also increases the $\Mll$ (Figure \ref{fig:wrMllVarMNu}).

%to draw a plot of the angle between the two leptons use this argument in TTree Draw within quotes, and multiplied by 180/3.1416
% acos(1-( (cosh(etaEle[0]-etaEle[1]) - cos(phiEle[0]-phiEle[1]))/(cosh(etaEle[0])*cosh(etaEle[1]))  ))

%see June 2015 for kinematic plots with fixed MWR and several low MNu
%see July 2016 answersToFirstRoundOfANQuestions for kinematic plots with fixed MWR and low, medium, and high MNu

The \DY+jets process produces $\ell\ell jj$ final state events that have low $\pt$ jets, and whose leptons have low $\Mll$.  Before 
producing a dilepton system via \DY, the interacting quarks radiate two partons.  These partons are radiated with a 
probability that is independent of $\phi$ and the angle $\theta$ relative to the beam axis, but decreases rapidly with $\pt$.  These 
partons recoil against the $Z/\gamma^{*}$ to conserve the initial quark system momentum, and are reconstructed as jets.  Due to 
the $Z$ boson resonance, the majority of \DY events produce lepton pairs reconstructed with $60 < \Mll < 120$ $\GeV$.  The $\Mll$ window 
constrains both leptons to have $15 \gtrsim \pt \lesssim 60$ $\GeV$, and their $\pt$ distributions peak at $M_{Z}/2$.  Events where 
the $Z$ boson has significant momentum, or the $\gamma^{*}$ has significant energy yield higher $\pt$ leptons, but at a significantly 
lower rate.

The top quark background, primarily $t\bar{t}$ and $t+W^{\pm}$, produces one bottom quark and one $W^{\pm}$ boson per top quark.  Both 
the bottom quark and $W$ boson can decay to a charged lepton.  In events where one or more top quarks are created, the $\ell\ell jj$ 
final state is realized when two $\ell$ are reconstructed from a combination of bottom quark and $W$ boson decays.  Although several 
top quark processes contribute to the total background, the dominant contribution is from $t\bar{t}$.  In $t\bar{t} \rightarrow \ell\ell jj$ 
events both $W$ bosons decay to a charged lepton via $W^{\pm} \rightarrow \ell\nu$, and, due to combinatorics, the $e\mu$ final state 
is produced twice as often as the $ee$ or $\mu\mu$ final state.  The reconstructed charged leptons are constrained by the $W$ mass to 
have $15 \gtrsim \pt \lesssim 50$ $\GeV$, and their $\pt$ distributions peak at $M_{W}/2$.  However, their invariant mass $\Mll$ can be 
as high as the $t\bar{t}$ rest mass.  The reconstructed lepton-jet invariant mass ($\Mlljj$) distribution found in $t\bar{t}$ events 
peaks below the $t\bar{t}$ mass because of the neutrinos from the $W$ decay.

The WZ and ZZ processes produce $\ell\ell jj$ final state events that have low $\pt$ jets, and whose leptons have low $\Mll$.  WZ and 
ZZ pairs can be produced with one off-shell boson ($M_{Z^{*}} < 90$ $\GeV$), but their production rate is maximized when both bosons are 
produced on-shell.  In both processes one $Z$ decays to leptons via $Z \rightarrow \ell\ell$.  The majority of these lepton pairs are 
reconstructed with $60 < \Mll < 120$ $\GeV$, and each lepton's $\pt$ distribution spans $15 \gtrsim \pt \lesssim 60$ $\GeV$ with a 
peak at $M_{Z}/2$.  The other $Z$ in ZZ, and the $W$ in WZ decay to quarks via $W/Z \rightarrow qq$.  The quarks are reconstructed as 
two jets whose dijet mass is consistent with the $W$ or $Z$ mass.  Similar to the leptons from the $Z$ decay, the $W/Z$ mass window 
and rest mass constrains each jet's $\pt$ distribution to $15 \gtrsim \pt \lesssim 50$ $\GeV$ with a peak at half the progenitor boson 
mass.  The reconstructed $\Mlljj$ distribution found in WZ and ZZ events peaks at the diboson rest mass.

The $qq/qg/gg \rightarrow$ WW, W+jets and QCD multi-jet backgrounds produce $\ell\ell jj$ final states with low $\pt$ leptons and jets.  
WW production contributes to the $\ell\ell jj$ final states when both bosons decay to charged leptons via $W^{\pm} \rightarrow \ell\nu$, 
and the initial state quarks or gluons radiate partons that are reconstructed as two jets.  Additionally, WW pairs yield lepton-jet final 
states when one boson decays to a charged lepton, the other boson decays to two quarks, and the initial state quarks or gluons radiate 
additional partons.  Such events contribute to $\ell\ell jj$ final states when the real lepton and two jets are correctly reconstructed, 
and one parton is incorrectly reconstructed as a second lepton.  Leptons and jets reconstructed from $W$ decay 
products are constrained by the $W$ mass to have $15 \gtrsim \pt \lesssim 50$ $\GeV$, while radiated partons, reconstructed as jets or 
leptons, are emitted with decreasing probability at higher $\pt$.  The $qq/qg \rightarrow W \rightarrow \ell\nu$+jets process radiates 
partons from the initial state quarks or gluons, and produces one charged lepton.  W+jets events contribute to $\ell\ell jj$ final states 
when the charged lepton and two jets are correctly reconstructed, and one parton is incorrectly reconstructed as a second lepton.  The 
$\ell$ from the $W$ decay is constrained by the $W$ mass to have $15 \gtrsim \pt \lesssim 50$ $\GeV$, and the radiated partons, 
reconstructed as jets or leptons, are emitted with decreasing probability at higher $\pt$.  The QCD multi-jet background contributes to 
$\ell\ell jj$ final states when at least 4 outgoing partons are produced, 2 are reconstructed as jets, and 2 are incorrectly reconstructed 
as leptons.  The outgoing partons, reconstructed as jets or leptons, are produced with a probability that decreases with $\pt$.

The $\pt$ distributions of leptons and jets reconstructed in simulated background events that pass the online trigger selection criteria 
are shown in Figure \ref{fig:bkgLeptJetPts}.

\begin{figure}
	\centering
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/ptMatchedRecoEleFromWr_mwr2200_mnu1100.pdf}
		\caption{$\ell$ from $\WR \rightarrow \ell\nul$}\label{fig:wrLeptJetPtsa}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/ptMatchedRecoEleFromNu_mwr2200_mnu1100.pdf}
		\caption{$\ell$ from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetPtsb}
	\end{subfigure}
	\newline
	\newline
	\newline
	\newline
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/ptMatchedRecoJetOne_mwr2200_mnu1100.pdf}
		\caption{jet from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetPtsc}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/ptMatchedRecoJetTwo_mwr2200_mnu1100.pdf}
		\caption{jet from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetPtsd}
	\end{subfigure}
	\caption{The $\pt$ of leptons and jets reconstructed in $\WR \rightarrow \ell\ell jj$ events with $\mWR = 2.2$ $\TeV$ 
		and $\mnul = \frac{1}{2}\mWR$.}\label{fig:wrLeptJetPts}
\end{figure}

\begin{figure}
	\centering
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/etaMatchedRecoEleFromWr_mwr2200_mnu1100.pdf}
		\caption{$\ell$ from $\WR \rightarrow \ell\nul$}\label{fig:wrLeptJetEtasa}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/etaMatchedRecoEleFromNu_mwr2200_mnu1100.pdf}
		\caption{$\ell$ from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetEtasb}
	\end{subfigure}
	\newline
	\newline
	\newline
	\newline
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/etaMatchedRecoJetOne_mwr2200_mnu1100.pdf}
		\caption{jet from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetEtasc}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/etaMatchedRecoJetTwo_mwr2200_mnu1100.pdf}
		\caption{jet from $\nul \rightarrow \ell jj$}\label{fig:wrLeptJetEtasd}
	\end{subfigure}
	\caption{The $\eta$ of leptons and jets reconstructed in $\WR \rightarrow \ell\ell jj$ events with $\mWR = 2.2$ $\TeV$ 
		and $\mnul = \frac{1}{2}\mWR$.}\label{fig:wrLeptJetEtas}
\end{figure}

\begin{figure}
	\centering
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		\caption{$\ell$ from $\WR \rightarrow \ell\nul$}\label{fig:wrLeptQrkPtsVarMNua}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		\caption{$\ell$ from $\nul \rightarrow \ell qq$}\label{fig:wrLeptQrkPtsVarMNub}
	\end{subfigure}
	\newline
	\newline
	\newline
	\newline
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		\caption{quark from $\nul \rightarrow \ell qq$}\label{fig:wrLeptQrkPtsVarMNuc}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		\caption{quark from $\nul \rightarrow \ell qq$}\label{fig:wrLeptQrkPtsVarMNud}
	\end{subfigure}
	\caption{The $\pt$ of leptons and quarks produced in $\WR \rightarrow \ell\ell qq$ events with $\mWR = 2.2$ $\TeV$ 
		and different \mnul.}\label{fig:wrLeptQrkPtsVarMNu}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figures/missingImage.png}
	\caption{The $|p|$ of the \nul produced in $\WR \rightarrow \ell\nul$ events with $\mWR = 2.2$ $\TeV$ and different \mnul.}
	\label{fig:hvyNuMomentumVarMNu}
\end{figure}

\begin{figure}
	\centering
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		%\caption{ }\label{fig:wrDrLeptQrkVarMNua}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/missingImage.png}
		%\caption{ }\label{fig:wrDrLeptQrkVarMNub}
	\end{subfigure}
	\caption{The $\Delta R(\ell,q)$ separation between the $\ell$ and both quarks produced by $\nul \rightarrow \ell qq$ 
		in $\WR \rightarrow \ell\ell qq$ events with $\mWR = 2.2$ $\TeV$ and different \mnul.}\label{fig:wrDrLeptQrkVarMNu}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figures/missingImage.png}
	\caption{The angle between the two leptons produced in $\WR \rightarrow \ell\ell qq$ events with $\mWR = 2.2$ $\TeV$ and 
	different \mnul.}
	\label{fig:wrLeptAngleSepVarMNu}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figures/missingImage.png}
	\caption{The $\Mll$ of the two leptons produced in $\WR \rightarrow \ell\ell qq$ events with $\mWR = 2.2$ $\TeV$ and 
	different \mnul.}
	\label{fig:wrMllVarMNu}
\end{figure}

\begin{figure}
	\centering
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/}
		\caption{leading $\pt$ $\ell$}\label{fig:bkgLeptJetPtsa}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/}
		\caption{subleading $\pt$ $\ell$}\label{fig:bkgLeptJetPtsb}
	\end{subfigure}
	\newline
	\newline
	\newline
	\newline
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/}
		\caption{leading $\pt$ jet}\label{fig:bkgLeptJetPtsc}
	\end{subfigure}
	\thickspace
	\begin{subfigure}[t]{2.4in}
		\centering
		\includegraphics[width=2.4in]{figures/}
		\caption{subleading $\pt$ jet}\label{fig:bkgLeptJetPtsd}
	\end{subfigure}
	\caption{The $\pt$ of leptons and jets reconstructed in simulated background events that passed the online 
	selection criteria.}\label{fig:bkgLeptJetPts}
\end{figure}


\subsection{Kinematic Selection Criteria}

%find plot of 2015 jet energy resolution vs pt and eta to help motivate jet pt and eta cut
%RESUME HERE



\section{Conclusion}
\label{sec:recoConclusion}
%conclusion for original reconstruction chapter, which did not include selection criteria
%Energetic electrons, muons and jets produced in collisions are reconstructed from signals measured in CMS sub-detectors and using 
%specialized reconstruction algorithms.  Reconstructed leptons and jets were required to pass additional selections to increase 
%sensitivity to a \WR signal relative to ST backgrounds.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
